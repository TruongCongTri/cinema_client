<!doctype html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>ADMIN | PHIM</title>

    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:300,400,500&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Serif+Pro:400,600&display=swap">
    <link rel="stylesheet" th:href="@{/fonts/icomoon/style.css}">
    <link rel="stylesheet" th:href="@{/css/owl.carousel.min.css}">

    <!-- Bootstrap CSS -->
    <link th:href="@{/css/main.css}" rel="stylesheet"/>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
          integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&amp;display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Condensed:300,400,700&amp;display=swap">
    <link rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.16.0/dist/bootstrap-table.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css">

    <!-- Style -->
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <link rel="stylesheet" th:href="@{/css/form-style.css}">
    <script th:src="@{/js/jquery-3.3.1.min.js}"></script>
    <!---->
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/gh/gitbrent/bootstrap4-toggle@3.6.1/css/bootstrap4-toggle.min.css">
    <script src="https://cdn.jsdelivr.net/gh/gitbrent/bootstrap4-toggle@3.6.1/js/bootstrap4-toggle.min.js"></script>
    <!---->
    <script src="https://cdn.tiny.cloud/1/7dza6b4k84mruc8aqfxwcn6fb4jdkknqdhba08g53bydxkka/tinymce/7/tinymce.min.js" referrerpolicy="origin"></script>
    <!---->
    <!--<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/css/bootstrap-select.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/js/bootstrap-select.min.js"></script>
-->
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
</head>
<body>
<th:block lang="vi" th:include="fragments/admin/navigation :: navigation"></th:block>
<main>
    <section class="ftco-section">
        <div class="container">
            <div class="row justify-content-center" style="margin: 40px;">
                <div class="col-md-6 text-center mb-5">
                    <h2 class="heading-section">QUẢN LÝ PHIM</h2>
                </div>
            </div>
            <div class="row justify-content-center">
                <div class="col-lg-12">
                    <div class="wrapper img">
                        <div class="row">
                            <div class="col-md-12 col-lg-12">
                                <div class="contact-wrap w-100 p-md-5 p-4">
                                    <form method="POST" id="contactForm" name="contactForm" class="contactForm"
                                          th:action="@{/admin/movies/update}" th:object="${movie}">
                                        <!--INPUT - id - cannot change-->
                                        <input th:field="*{id}" type="hidden"/>
                                        <!--INPUT - name-->
                                        <div class="form-select " style="margin:10px 20px 10px 0 ;">
                                            <span class="film__age--C" style="font-size: large;">Tên Phim:</span>
                                            <input type="text" th:field="*{name}"
                                                   class="form-control" placeholder="Nhập Tên phim"
                                                   aria-label="Default" aria-describedby="inputGroup-sizing-default">
                                        </div>
                                        <!--INPUT - poster-->
                                        <div class="form-select" style="margin:10px 20px 10px 0 ;">
                                            <span class="film__age--C" style="font-size: large;">Áp phích:</span>
                                            <input type="text" th:field="*{smallImageURL}"
                                                   class="form-control" placeholder="Nhập đường dẫn Áp phích"
                                                   aria-label="Default" aria-describedby="inputGroup-sizing-default">
                                        </div>
                                        <div style="margin:10px 20px 10px 0 ;" th:if="*{smallImageURL}">
                                            <img id="poster-img" style="max-width:50%;" th:src="${movie.smallImageURL}" alt="">
                                        </div>
                                        <!--INPUT - banner-->
                                        <div class="form-select" style="margin:10px 20px 10px 0 ;">
                                            <span class="film__age--C" style="font-size: large;">Ảnh bìa:</span>
                                            <input type="text" th:field="*{largeImageURL}"
                                                   class="form-control" placeholder="Nhập đường dẫn Ảnh bìa"
                                                   aria-label="Default" aria-describedby="inputGroup-sizing-default">
                                        </div>
                                        <div style="margin:10px 20px 10px 0 ;" th:if="*{largeImageURL}">
                                            <img id="banner-img" style="max-width:50%;" th:src="${movie.largeImageURL}" alt="">
                                        </div>
                                        <!--INPUT - description-->
                                        <div class="form-select" style="margin:10px 20px 10px 0 ;">
                                            <span class="film__detail" style="font-size: large;">Mô tả:</span>
                                            <textarea rows="15" cols="70" th:field="*{longDescription}"
                                                      placeholder="Nhập đoạn Mô tả"
                                                      aria-label="Default" aria-describedby="inputGroup-sizing-default">
                                            </textarea>
                                        </div>
                                        <!--DATE - release date-->
                                        <div class="form-select" style="margin:10px 20px 10px 0 ;">
                                            <span class="film__timming" style="font-size: large;">Ngày khởi chiếu:</span>
                                            <input type="date" th:field="*{releaseDate}"
                                                   class="form-control"
                                                   aria-label="Default" aria-describedby="inputGroup-sizing-default">
                                        </div>
                                        <!--NUMBER - runtime-->
                                        <div class="form-select" style="margin:10px 20px 10px 0 ;">
                                            <span class="film__during" style="font-size: large;">Thời lượng:</span>
                                            <input type="number" min="0" th:field="*{duration}"
                                                   class="form-control"
                                                   aria-label="Default" aria-describedby="inputGroup-sizing-default">
                                        </div>
                                        <!--URL - trailer-->
                                        <div class="form-select" style="margin:10px 20px 10px 0 ;">
                                            <span class="film__link" style="font-size: large;">Trailer:</span>
                                            <input type="url" th:field="*{trailerURL}"
                                                   class="form-control" placeholder="Nhập đường dẫn trailer"
                                                   aria-label="Default" aria-describedby="inputGroup-sizing-default">
                                        </div>
                                        <!--INPUT - language-->
                                        <div class="form-select" style="margin:10px 20px 10px 0 ;">
                                            <span class="film__detail" style="font-size: large;">Ngôn ngữ::</span>
                                            <input type="text" th:field="*{language}"
                                                   class="form-control" placeholder="Nhập Ngôn ngữ"
                                                   aria-label="Default" aria-describedby="inputGroup-sizing-default">
                                        </div>
                                        <!--DROPDOWN list - certification-->
                                        <div class="form-select" style="margin: 10px 20px 10px 0">
                                            <span class="film__age--C" style="font-size: large">Phân loại độ tuổi:</span>
                                            <select th:field="*{rated.id}" id="listRated" class="form-control form-control-lg">
                                                <option th:each="c: ${certificates}" th:value="${c.id}"
                                                        th:text="${c.name}" th:selected="(${c.id} == *{rated.id})">
                                                </option>
                                            </select>
                                        </div>
                                        <!--SELECT multi - directors-->
                                        <div class="form-select" style="margin:10px 20px 10px 0 ;">
                                            <span class="film__age--C" style="font-size: large;">Đạo diễn:</span>
                                            <select id="listDirs" class="form-control form-control-lg multi-select" name="director"
                                                    multiple="multiple">
                                                <option th:each="d: ${directors}" th:value="${d.id}"
                                                        th:text="${d.name}">
                                                </option>
                                            </select>
                                        </div>
                                        <!--SELECT multi - actors-->
                                        <div class="form-select" style="margin:10px 20px 10px 0 ;">
                                            <span class="film__age--C" style="font-size: large;">Diễn viên:</span>
                                            <select id="listActs" class="form-control form-control-lg multi-select" name="actor"
                                                    multiple="multiple">
                                                <option th:each="a: ${actors}" th:value="${a.id}"
                                                        th:text="${a.name}">
                                                </option>
                                            </select>
                                        </div>
                                        <!--SELECT multi - genres-->
                                        <div class="form-select" style="margin:10px 20px 10px 0 ;">
                                            <span class="film__age--C" style="font-size: large;">Thể loại:</span>
                                            <select id="listGens" class="form-control form-control-lg multi-select" name="genre"
                                                    multiple="multiple">
                                                <option th:each="g: ${genres}" th:value="${g.id}"
                                                        th:text="${g.vieName}">
                                                </option>
                                            </select>
                                        </div>
                                        <!--TOGGLE - showing-->
                                        <div class="input-group mb-3">
                                            <input id="check-showing" name="checkShowing" type="checkbox"
                                                   th:checked="${movie.isShowing==1}"
                                                   data-toggle="toggle" data-onstyle="primary" data-offstyle="secondary"
                                                   data-on="Đang chiếu" data-off="Sắp chiếu">
                                        </div>
                                        <!--TOGGLE - active-->
                                        <div class="input-group mb-3">
                                            <input id="check-active" name="checkActive" type="checkbox"
                                                   th:checked="${movie.isActive==1}"
                                                   data-toggle="toggle" data-onstyle="primary" data-offstyle="secondary"
                                                   data-on="Đang hoạt động" data-off="Không hoạt động">
                                        </div>
                                        <!--BTN - save data-->
                                        <div class="form-group">
                                            <input id="btn-post" type="submit" value="LƯU" class="btn btn-primary">
                                            <div class="submitting"></div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <div id="error--login" class="swal-overlay" tabindex="-1">
        <div class="swal-modal" role="dialog" aria-modal="true">
            <div class="swal-icon swal-icon--error">
                <div class="swal-icon--error__x-mark">
                    <span class="swal-icon--error__line swal-icon--error__line--left"></span>
                    <span class="swal-icon--error__line swal-icon--error__line--right"></span>
                </div>
            </div>
            <div class="swal-title">Đầu vào không được để trống!</div>
            <div class="swal-footer">
                <div class="swal-button-container">
                    <button class="swal-button swal-button--confirm">ĐỒNG Ý</button>
                    <div class="swal-button__loader"></div>
                </div>
            </div>
        </div>
    </div>
</main>
<script th:inline="javascript">
    $(document).ready(function () {
        $(".multi-select").select2({
            allowClear: true
        });
        /*START - preselect directors*/
        $('#listDirs').select2({
            placeholder: 'Chọn đạo diễn',
            allowClear: true
        });
        let PRESELECTED_DIRS = [];
        PRESELECTED_DIRS = [[${movie.directors}]];
        let  PRESELECTED_DIR_IDS = [];
        if (PRESELECTED_DIRS.length === 0) {
            console.log("empty directors");
        } else {
            PRESELECTED_DIRS.forEach(act => {
                PRESELECTED_DIR_IDS.push(act.id);
            });
            console.log(PRESELECTED_DIR_IDS);
            $('#listDirs').val(PRESELECTED_DIR_IDS).trigger('change');
        }
        /*END - preselect directors*/

        /*START - preselect actors*/
        $('#listActs').select2({
            placeholder: 'Chọn diễn viên',
            allowClear: true
        });
        let PRESELECTED_ACTORS = [];
        PRESELECTED_ACTORS = [[${movie.actors}]];
        let PRESELECTED_ACTOR_IDS = [];
        if (PRESELECTED_ACTORS.length === 0) {
            console.log("empty actors");
        } else {
            PRESELECTED_ACTORS.forEach(act => {
                PRESELECTED_ACTOR_IDS.push(act.id);
            });
            console.log(PRESELECTED_ACTOR_IDS);
            $('#listActs').val(PRESELECTED_ACTOR_IDS).trigger('change');
        }
        /*END - preselect actors*/

        /*START - preselect genres*/
        $('#listGens').select2({
            placeholder: 'Chọn thể loại',
            allowClear: true
        });
        let PRESELECTED_GENRES = [];
        PRESELECTED_GENRES = [[${movie.categories}]];
        let PRESELECTED_GENRE_IDS = [];
        if (PRESELECTED_GENRES.length === 0) {
            console.log("empty genres");
        } else {
            PRESELECTED_GENRES.forEach(act => {
                PRESELECTED_GENRE_IDS.push(act.id);
            });
            console.log(PRESELECTED_GENRE_IDS);
            $('#listGens').val(PRESELECTED_GENRE_IDS).trigger('change');
        }
        /*END - preselect genres*/

        $("#btn-post").click(function (event) {
            event.preventDefault();
            var emty = false
            $(".form-control").each(function () {
                if ($(this).val() == '0' || $(this).val() == '' || $(this).val() == null) {
                    emty = true
                }
                console.log($(this).val())
            })
            if (emty) {
                $("#error--login").addClass("swal-overlay--show-modal")
            } else {
                $("#contactForm").submit();
            }
        })
        $(document).ready(function () {
            $("#error--login").click(function (e) {
                $(this).removeClass("swal-overlay--show-modal");
            });

        });
    });

</script>
<script>
    tinymce.init({
        selector: 'textarea',
        plugins: 'anchor autolink charmap codesample emoticons image link lists media searchreplace table visualblocks wordcount linkchecker',
        toolbar: 'undo redo | blocks fontfamily fontsize | bold italic underline strikethrough | link image media table | align lineheight | numlist bullist indent outdent | emoticons charmap | removeformat',
    });
</script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
        integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
        crossorigin="anonymous"></script>
<script th:src="@{/js/popper.min.js}"></script>
<script th:src="@{/js/main.js}"></script>
</body>
</html>